<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width-device-width", initial-scale="1.0"> 
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@3.6.11/dist/vuetify.min.css">
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vuetify@3.6.11/dist/vuetify.min.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
        <title>BetterBook</title>
    </head>
    <body>
        <div id="app">
            <v-app>
            <v-main>

            <div id="spashpage" v-if="currentPage === 'splash'">
                <h1>Join Millions of Users Today!</h1>
            </div>

            <div id="login" v-if="currentPage === 'login'">
                <h1>BetterBook</h1>
                <form @submit.prevent="loginUser()">
                    <div class="loginForm" placeholder="YourEmail@YourEmail.com">
                        Email
                        <input type="email" v-model="user.email">
                        Password
                        <input type="password" v-model="user.password">
                    <button>Log In</button>
                    Don't have an account? <div class="signUpHover" @click="switchPage('signUp')">Sign Up!</div>
                    </div> 
                </form>
            </div>

            <div id="login" v-if="currentPage === 'signUp'">
                <div id="paddingsquare">
                <h1>Sign Up for BetterBook Today!</h1>
                    <form @submit.prevent="registerUser()">
                        <div class="loginForm">
                            Username
                            <input type="username" v-model="user.username">
                            Email
                            <input type="email" v-model="user.email">
                            Password
                            <input type="password" v-model="user.password">
                            <button>Register</button>
                            Already have an account? <div class="signUpHover" @click="switchPage('login')">Log in!</div>
                        </div>
                    </form>
                </div>
            </div>

            <div id="homepage" v-if="currentPage === 'homepage' | currentPage === 'profile'">
                <div id="homeTopbar">
                    <div class="searchbar">
                        <p>Welcome, {{currentUser.username}} !</p>
                        <input type="text" placeholder="Search books...">
                    </div>
                    <nav>
                        <div @click="switchPage('homepage')">Home</div>
                        <div @click="switchPage('profile')">Profile</div>
                        <div @click="deleteSession()">Sign Out</div>
                    </nav>
                </div>

                <div id="homefeed" v-if="currentPage === 'homepage'">
                    <div class="booklist">
                        <p>Add a book</p>
                        <form @submit.prevent="addBooks()">
                            <p>Title</p>
                            <input type="text" v-model="newBook.title">
                            <p>ISBN</p>
                            <input type="number" v-model="newBook.isbn">
                            <p>Summary</p>
                            <input type="text" v-model="newBook.summary">
                            <button>Submit</button>
                        </form>
                    </div>
                    
                    <div class="mainfeed">
                        <div id="homehero">
                            <v-carousel
                            show-arrows="hover"
                            cycle>
                                <v-carousel-item
                                  src="Images/beachread.jpg"
                                  cover
                                ></v-carousel-item>
                              
                                <v-carousel-item
                                  src="Images/bookrainbow.jpg"
                                  cover
                                ></v-carousel-item>
                              
                                <v-carousel-item
                                  src="Images/habitbooks.jpg"
                                  cover
                                ></v-carousel-item>
                              </v-carousel>
                        </div>
                        <div>
                            <p>Recently Read</p>
                            <div v-for="(book, index) in books">
                                <div v-if="book.owner === currentUser._id">
                                    <p>{{ book.title }}</p>
                                    <p> {{ book.summary }} </p>
                                    <button @click="toggleBookModal(index)">Edit</button>
                                    <button @click="deleteBook(book)">Delete</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="modal" v-show="openBookModal">
                            <p>Edit Book</p>
                            <p @click="toggleBookModal()">X</p>
                            <form @submit.prevent="editBook(book)">
                                <p>Update Title</p>
                                <input type="text" v-model="modalBook.title">
                                <p>Update ISBN</p>
                                <input type="number" v-model="modalBook.isbn">
                                <p>Update Summary</p>
                                <input type="text" v-model="modalBook.summary">
                                <button>Update profile</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div id="profile" v-if="currentPage === 'profile'">
                    <div class="profileDisplay">
                        <div v-for="(profile, index) in profiles">
                            <div v-if="profile.owner === currentUser._id">
                                <p>{{ profile.bio }}</p>
                                <p>{{ profile.location }}</p>
                                <p>{{ profile.displayName }}</p>
                                <p>{{ profile.interests }}</p>
                                <button @click="toggleModal(index)">Edit</button>
                                <button @click="deleteProfile(index)">Delete</button>
                            </div>
                        </div>
                    </div>

                    <div id="profileCreator">
                        <h1>Create Your Profile</h1>
                        <form @submit.prevent="createProfile()">
                            <p>Create Bio</p>
                            <input type="text" v-model="newProfile.bio">
                            <p>Create Location</p>
                            <input type="text" v-model="newProfile.location">
                            <p>Create Display Name</p>
                            <input type="text" v-model="newProfile.displayName">
                            <p>Add Interests</p>
                            <input type="text" v-model="newProfile.interests"> <br>
                            <button>Create profile</button>
                        </form>
                    </div>

                    <div class="modal" v-show="openModal">
                        <h1>Edit your Profile</h1>
                        <p @click="toggleModal()">X</p>
                        <form @submit.prevent="editProfile(profile)">
                            <p>Update Bio</p>
                            <input type="text" v-model="modal.bio">
                            <p>Update Location</p>
                            <input type="text" v-model="modal.location">
                            <p>Change Display Name</p>
                            <input type="text" v-model="modal.displayName">
                            <p>Edit Interests</p>
                            <input type="text" v-model="modal.interests">
                            <button>Update profile</button>
                        </form>
                    </div>
                    <button>Delete Your Account (Not working yet)</button>
                </div>
            </div>
            </v-main>
            </v-app>
        </div>
        <script src="app.js"></script>
    </body>
</html>